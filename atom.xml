<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>木欣欣然</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2016-08-20T15:40:52.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Marvin</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>LeetCode解决方案之DataBase</title>
    <link href="http://yoursite.com/2016/08/15/LeetCode%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8BDataBase/"/>
    <id>http://yoursite.com/2016/08/15/LeetCode解决方案之DataBase/</id>
    <published>2016-08-15T04:06:59.000Z</published>
    <updated>2016-08-20T15:40:52.000Z</updated>
    
    <content type="html">&lt;p&gt;此篇博客主要用于学习和交流LeetCode 关于DataBase部分解答方案。&lt;/p&gt;
&lt;h2 id=&quot;rankscores-难度等级&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#rankscores-难度等级&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;RankScores&lt;/strong&gt;，难度等级:⭐️⭐️⭐️&lt;/h2&gt;
&lt;p&gt; Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no “holes” between ranks.&lt;/p&gt;
&lt;figure class=&quot;highlight gherkin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; Score &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 1  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3.50  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 2  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3.65  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 4.00  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 4  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3.85  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 5  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 4.00  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 6  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3.65  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;For example, given the above Scores table, your query should generate the following report (order by highest score):&lt;/p&gt;
&lt;figure class=&quot;highlight gherkin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+-------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; Score &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; Rank &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 4.00  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 1    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 4.00  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 1    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3.85  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 2    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3.65  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3.65  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 3    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3.50  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; 4    &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------+------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;题目意思&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;编写SQL对得分表中的得分排名，允许存在并列的排名，但名次之间是连续的不允许有空缺。
例如：当两名选手得分相同且均为最高得分，则两者并列第一。接着对分数为第二高的选手进行排名，名词为第二名，以此类推。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;思路： 对所有的记录进行唯一排名，对某一位选手的得分统计其得分在唯一排名表中的位置确定其名次&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; s.Score, (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;count&lt;/span&gt;(*) &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;distinct&lt;/span&gt;(Score) &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Scores &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Score &lt;span class=&quot;keyword&quot;&gt;desc&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; r &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; r.Score &amp;gt;= s.Score) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Rank&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Scores &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; s &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Score &lt;span class=&quot;keyword&quot;&gt;desc&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;rising-temperature-难度等级&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#rising-temperature-难度等级&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;Rising Temperature&lt;/strong&gt;, 难度等级⭐️&lt;/h2&gt;
&lt;p&gt;Given a Weather table, write a SQL query to find all dates’ Ids with higher temperature compared to its previous (yesterday’s) dates.&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# 示例表格&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------+------------+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id(INT) | Date(DATE) | Temperature(INT) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------+------------+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|       1 | 2015-01-01 |               10 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|       2 | 2015-01-02 |               25 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|       3 | 2015-01-03 |               20 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;|       4 | 2015-01-04 |               30 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------+------------+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;题目意思&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;编写SQL找出Weather表中当天温度比前一天温度高的记录的Id&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;思路：查询前一天的温度，将当天的温度和前天的温度进行对比&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Weather &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; cur &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Temperature &amp;gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; Temperature &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Weather &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;date_add&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;interval&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;day&lt;/span&gt;) = cur.Date );&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; wt1.Id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; Weather wt1, Weather wt2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; wt1.Temperature &amp;gt; wt2.Temperature &lt;span class=&quot;keyword&quot;&gt;AND&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;TO_DAYS&lt;/span&gt;(wt1.DATE)-&lt;span class=&quot;keyword&quot;&gt;TO_DAYS&lt;/span&gt;(wt2.DATE)=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;customers-who-never-order-难度等级&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#customers-who-never-order-难度等级&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;Customers Who Never Order&lt;/strong&gt; 难度等级⭐️&lt;/h2&gt;
&lt;p&gt;Suppose that a website contains two tables, the Customers table and the Orders table. Write a SQL query to find all customers who never order anything.&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# Customers表&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | Name  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | Joe   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 2  | Henry |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 3  | Sam   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 4  | Max   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Table: Orders&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# Orders表&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | CustomerId |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | 3          |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 2  | 1          |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;题目意思&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;编写SQL找出没有预定商品的客户&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：
将客户表和订单表合并，找出CustomerId为null的值&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Name&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; Customers&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; Customers.Id, &lt;span class=&quot;keyword&quot;&gt;Name&lt;/span&gt;, CustomerId &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Customers &lt;span class=&quot;keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; Orders &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; Customers.Id = CustomerId) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; s.CustomerId &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;duplicate-emails-难度系数：&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#duplicate-emails-难度系数：&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;Duplicate Emails&lt;/strong&gt;, 难度系数：⭐️&lt;/h2&gt;
&lt;p&gt;Write a SQL query to find all duplicate emails in a table named Person.&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# Person表&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+---------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | Email   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+---------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | a@b.com |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 2  | c@d.com |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 3  | a@b.com |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+---------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;题目意思&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;编写SQL找出Person表中邮件重复的记录&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;通过group by找到每条记录重复的条数，选择重复条数大于1的记录&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;distinct&lt;/span&gt;(Email) &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; Email, &lt;span class=&quot;keyword&quot;&gt;count&lt;/span&gt;(*) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; counts &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Person &lt;span class=&quot;keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Email) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; t &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; counts&amp;gt;= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;delete-duplicates-emals-难度系数：&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#delete-duplicates-emals-难度系数：&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;Delete Duplicates Emals&lt;/strong&gt;, 难度系数：⭐️&lt;/h2&gt;
&lt;p&gt;Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id.&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# Id is the primary key column for this table.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | Email            |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | john@example.com |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 2  | bob@example.com  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 3  | john@example.com |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;** 题目意思 **：&lt;/p&gt;
&lt;p&gt;编写SQL删除表中重复的字段，同时保留唯一Id较小的字段&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：
思路：采用inner join, 对表自身进行内连接，然后删除符合条件的记录&lt;/p&gt;
&lt;figure class=&quot;highlight armasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;Delete&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;p1&lt;/span&gt; from Person &lt;span class=&quot;built_in&quot;&gt;p1&lt;/span&gt; inner join Person &lt;span class=&quot;built_in&quot;&gt;p2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;p1&lt;/span&gt;.Email = &lt;span class=&quot;built_in&quot;&gt;p2&lt;/span&gt;.Email &lt;span class=&quot;keyword&quot;&gt;and &lt;/span&gt;&lt;span class=&quot;built_in&quot;&gt;p1&lt;/span&gt;.Id &amp;gt; &lt;span class=&quot;built_in&quot;&gt;p2&lt;/span&gt;.Id&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;trips-and-users-难度系数：&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#trips-and-users-难度系数：&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;Trips and Users&lt;/strong&gt;, 难度系数：⭐️⭐️⭐️&lt;/h2&gt;
&lt;p&gt;The Trips table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the Users table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).&lt;/p&gt;
&lt;figure class=&quot;highlight gherkin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+----+-----------+-----------+---------+--------------------+----------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; Client_Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; Driver_Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; City_Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;        Status      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;Request_at&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-----------+-----------+---------+--------------------+----------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 1  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     1     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    10     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    1    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-01&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 2  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     2     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    11     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    1    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; cancelled_by_driver&lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-01&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 3  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     3     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    6    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-01&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 4  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     4     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    13     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    6    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; cancelled_by_client&lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-01&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 5  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     1     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    10     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    1    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-02&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 6  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     2     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    11     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    6    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-02&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 7  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     3     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    6    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-02&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 8  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     2     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-03&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 9  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     3     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    10     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     completed      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-03&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; 10 &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;     4     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    13     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;    12   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; cancelled_by_driver&lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;2013-10-03&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+-----------+-----------+---------+--------------------+----------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The Users table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).&lt;/p&gt;
&lt;figure class=&quot;highlight gherkin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+----------+--------+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt; Users_Id &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; Banned &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;  Role  &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------+--------+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    1     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; client &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    2     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   Yes  &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; client &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    3     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; client &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    4     &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; client &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    10    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; driver &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    11    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; driver &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    12    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; driver &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|&lt;span class=&quot;string&quot;&gt;    13    &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;   No   &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; driver &lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------+--------+--------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Write a SQL query to find the cancellation rate of requests made by unbanned clients between Oct 1, 2013 and Oct 3, 2013.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;题目意思&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;编写SQL查询语句，查找由非禁止用户在2013年10月1日至2013年10月3日取消订单的取消率&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决放案&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;方案一：&lt;/p&gt;
&lt;p&gt;利用分组查询查找取消记录和总记录，求两者的比值。查询的条件为非禁止客户，时间为2013年10月1日至3日。&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; c.Day &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Day&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;IfNull&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;round&lt;/span&gt;(cancled / Total, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Cancellation Rate&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;count&lt;/span&gt;(*) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; Total, Request_at &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Day&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Trips &lt;span class=&quot;keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Users&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; Client_Id = Users_Id) a &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Banned=&lt;span class=&quot;string&quot;&gt;&quot;No&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; Request_at &lt;span class=&quot;keyword&quot;&gt;between&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;2013-10-01&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;2013-10-03&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Request_at&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;) c &lt;span class=&quot;keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;count&lt;/span&gt;(*) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; cancled, Request_at &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Day&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Trips &lt;span class=&quot;keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Users&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; Client_Id = Users_Id) b &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Banned=&lt;span class=&quot;string&quot;&gt;&quot;No&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Status&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;cancelled%&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Request_at&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;) d &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; c.Day = d.Day;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;方案二：&lt;/p&gt;
&lt;p&gt;对Trips表和Users表进行左连接，求完成和取消的订单数，再求两者之间的比值。此处用到If语句&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; Request_at &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Day&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;round&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;sum&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;Status&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;completed&#39;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) / &lt;span class=&quot;keyword&quot;&gt;count&lt;/span&gt;(*), &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Cancellation Rate&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Trips &lt;span class=&quot;keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Users&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; Client_Id = Users_Id &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Banned=&lt;span class=&quot;string&quot;&gt;&quot;NO&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Request_at &lt;span class=&quot;keyword&quot;&gt;between&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;2013-10-01&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;2013-10-03&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Request_at;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;此篇博客主要用于学习和交流LeetCode 关于DataBase部分解答方案。&lt;/p&gt;
&lt;h2 id=&quot;rankscores-难度等级&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#rankscores-难度等级&quot;&gt;¶&lt;/a&gt;&lt;strong&gt;RankSc
    
    </summary>
    
      <category term="练习" scheme="http://yoursite.com/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>MySQL排序</title>
    <link href="http://yoursite.com/2016/08/15/MySQL%E6%8E%92%E5%BA%8F/"/>
    <id>http://yoursite.com/2016/08/15/MySQL排序/</id>
    <published>2016-08-15T02:15:19.000Z</published>
    <updated>2016-08-15T04:59:25.000Z</updated>
    
    <content type="html">&lt;p&gt;在MySQL中经常会涉及到排序的问题：如查询第N大的数值。其基本思路如下：通过对所有的查询记录进行倒序排名，查询其前N条记录并取最后一条记录。&lt;/p&gt;
&lt;p&gt;LeetCode中求Salary排名第二的记录
Write a SQL query to get the second highest salary from the Employee table&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# 示例样表&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | Salary |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | 100    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 2  | 200    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 3  | 300    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;For example, given the above Employee table, the  n(th) highest salary where n = 2 is 200. If there is no nth highest salary, then the query should return null.&lt;/p&gt;
&lt;p&gt;解答方案一：&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;max&lt;/span&gt;(Salary) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; SecondHighestSalary &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Employee &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Salary &amp;lt; (&lt;span class=&quot;keyword&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;max&lt;/span&gt;(Salary) &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Employee);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解答方案二：&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; Salary &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Employee &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; Salary = (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;distinct&lt;/span&gt;(Salary) &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Employee &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Salary &lt;span class=&quot;keyword&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt;  SecondHighestSalary;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;两种方案有着较大区别，方案一返回的结果集为一条记录；而方案二的结果集为多条记录。方案一的思路为先找到所有记录中最大值，然后找比最大集小的集合，再从该集合中找出数值最大的记录。该方法有其局限性，只能找到第二大的记录。相反，方案二思路先对所有记录进行唯一排名，然后然后找到排名第二的记录，最终的结果通过对比所有记录中与排名第二记录，相等的记录则并列第二。从而，方案二可以选出排名并列的记录。并且方案二更具有通用性，其可根据排名查找第n大的记录。&lt;/p&gt;
&lt;p&gt;同时，从上述的解决方案可以看出，当查询集为null的时候，查询的结果为null。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在MySQL中经常会涉及到排序的问题：如查询第N大的数值。其基本思路如下：通过对所有的查询记录进行倒序排名，查询其前N条记录并取最后一条记录。&lt;/p&gt;
&lt;p&gt;LeetCode中求Salary排名第二的记录
Write a SQL query to get the secon
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL之分页</title>
    <link href="http://yoursite.com/2016/08/15/MySQL%E4%B9%8B%E5%88%86%E9%A1%B5/"/>
    <id>http://yoursite.com/2016/08/15/MySQL之分页/</id>
    <published>2016-08-14T16:02:31.000Z</published>
    <updated>2016-08-15T04:24:01.000Z</updated>
    
    <content type="html">&lt;p&gt; 在MySQL的官方文档中是这样描述&lt;code&gt;limit&lt;/code&gt;优化查询的：如果你想查询指定数目的结果集，采用limit限制查询次数是一个不错的选择。这样，你就不用查询全部的数据集，然后丢掉额外的数据了。&lt;/p&gt;
&lt;p&gt; 进行limit优化，可以从以下几个方面考虑：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;采用索引查询(这个可以结合索引文件进行分析，MyISAM生成一个表需要3个文件：表结构文件、表记录文件和索引文件；InnoDB则是数据文件和索引文件为同一个文件)；&lt;/li&gt;
&lt;li&gt;如果结果集存在排序的情景，先进行查询结果集的数量限制，然后对结果集进行排序；&lt;/li&gt;
&lt;li&gt;如果采用  &lt;code&gt;DISTINCT&lt;/code&gt;查询，当找到所有符合唯一记录时停止查询；&lt;/li&gt;
&lt;li&gt;如果服务器使用临时表来解决查询，那么可以通过limit 条数计算表所需的空间；&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;limit详细用法&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#limit详细用法&quot;&gt;¶&lt;/a&gt;limit详细用法&lt;/h2&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; table_name &lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; [&lt;span class=&quot;keyword&quot;&gt;offset&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;rows&lt;/span&gt;] | &lt;span class=&quot;keyword&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;OFFSET&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;offset&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;limit&lt;/code&gt;用于强制返回结果集的数目，其接受一个或两个参数。第一个参数返回结果集的偏移，第二个结果集返回结果集的行数。&lt;font color=&quot;ff0000&quot;&gt;初始记录的行偏移从0开始。 例如：&lt;/font&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; table_name &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;表示查询的记录为5-14。&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * frome table_name limt &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;表示查询从6 至最后一条记录&lt;/p&gt;
&lt;h2 id=&quot;分页优化查询&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#分页优化查询&quot;&gt;¶&lt;/a&gt;分页优化查询&lt;/h2&gt;
&lt;p&gt;分页优化查询的终极目标为没有分页，然而现实总是和理想存在着偏差&lt;/p&gt;
&lt;h3 id=&quot;场景一：&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#场景一：&quot;&gt;¶&lt;/a&gt;场景一：&lt;/h3&gt;
&lt;p&gt;语句A:&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;语句B:&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;98200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从查询结果看语句A和B的结果集均为20条记录，但是语句A的查询时间远小于语句B。原因是语句B需要先扫面98200条语句进行排序，而语句A则只需要扫描100条语句再进行排序。&lt;/p&gt;
&lt;p&gt;优化方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;子查询：先查询倒序id最大的数值，然后顺序取10条&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;98199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;表连接：先获取id结果集，然后将结果集与原表&amp;quot;inner join&amp;quot;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; tb_name &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;98200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;) t &lt;span class=&quot;keyword&quot;&gt;using&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;leedcode示例：&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#leedcode示例：&quot;&gt;¶&lt;/a&gt;LeedCode示例：&lt;/h2&gt;
&lt;p&gt;Write a SQL query to get the n_th highest salary from the Employee table&lt;/p&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;# 示例表如下：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Id | Salary |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 1  | 100    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 2  | 200    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 3  | 300    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----+--------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决方案：&lt;/p&gt;
&lt;figure class=&quot;highlight oxygene&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FUNCTION&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNthHighestSalary&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(N INT)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RETURNS&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;INT&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BEGIN&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;DECLARE&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;INT&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; M = N -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  RETURN (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      # &lt;span class=&quot;keyword&quot;&gt;Write&lt;/span&gt; your MySQL query statement below.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DISTINCT&lt;/span&gt; Salary &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Employee &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; Salary &lt;span class=&quot;keyword&quot;&gt;desc&lt;/span&gt; limit M, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;END&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当去掉DISTINCT该方法错误，这个与DISTINCT用法有关。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; 在MySQL的官方文档中是这样描述&lt;code&gt;limit&lt;/code&gt;优化查询的：如果你想查询指定数目的结果集，采用limit限制查询次数是一个不错的选择。这样，你就不用查询全部的数据集，然后丢掉额外的数据了。&lt;/p&gt;
&lt;p&gt; 进行limit优化，可以从以下几个方面考虑：
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>哈哈哈</title>
    <link href="http://yoursite.com/2016/06/25/%E5%93%88%E5%93%88%E5%93%88/"/>
    <id>http://yoursite.com/2016/06/25/哈哈哈/</id>
    <published>2016-06-24T16:29:32.000Z</published>
    <updated>2016-08-15T01:26:46.000Z</updated>
    
    <content type="html">&lt;p&gt;  为生活找点乐趣，看自己处在一个怎样的位置！&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/fmeyer/289467&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;python程序员发展历程&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;虽然这边文章在newsletter发表很多年了，但是还是有点乐趣的!&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  为生活找点乐趣，看自己处在一个怎样的位置！&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/fmeyer/289467&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;python程序员发展历程&lt;/a&gt;
    
    </summary>
    
      <category term="有趣" scheme="http://yoursite.com/categories/%E6%9C%89%E8%B6%A3/"/>
    
    
      <category term="language" scheme="http://yoursite.com/tags/language/"/>
    
  </entry>
  
  <entry>
    <title>Scrapy模拟登录</title>
    <link href="http://yoursite.com/2016/06/22/Scrapy%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/"/>
    <id>http://yoursite.com/2016/06/22/Scrapy模拟登录/</id>
    <published>2016-06-21T17:09:08.000Z</published>
    <updated>2016-06-21T17:13:46.000Z</updated>
    
    <content type="html">&lt;p&gt; 
参考文献：&lt;/p&gt;
&lt;p&gt;[1] &lt;a href=&quot;http://doc.scrapy.org/en/latest/intro/tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://doc.scrapy.org/en/latest/intro/tutorial.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;http://www.jianshu.com/p/b7f41df6202d&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.jianshu.com/p/b7f41df6202d&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; 
参考文献：&lt;/p&gt;
&lt;p&gt;[1] &lt;a href=&quot;http://doc.scrapy.org/en/latest/intro/tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://doc.scrapy.org/en/
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Scrapy" scheme="http://yoursite.com/tags/Scrapy/"/>
    
  </entry>
  
  <entry>
    <title>Flask-Apache部署</title>
    <link href="http://yoursite.com/2016/06/19/Flask-Apache%E9%83%A8%E7%BD%B2/"/>
    <id>http://yoursite.com/2016/06/19/Flask-Apache部署/</id>
    <published>2016-06-19T12:50:13.000Z</published>
    <updated>2016-06-19T17:48:47.000Z</updated>
    
    <content type="html">&lt;p&gt;  Apache Web服务诞生于1995年, 目前在所有网站中，Apache服务的占有率第一。由于多年的发展，其服务相对于其他网站部署服务更加稳定。在面对性能要求不苛刻而对稳定性要求较高的情况下，优先选择Apache。当然，为了应对性能需求，更好的选择为Ngnix。Flask为轻型的python web框架，对apache有着 完美的支持。
以下为利用Apache部署Flask的实验：&lt;/p&gt;
&lt;h2 id=&quot;项目环境&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#项目环境&quot;&gt;¶&lt;/a&gt;项目环境&lt;/h2&gt;
&lt;p&gt;系统： ubuntu14.04&lt;/p&gt;
&lt;h2 id=&quot;flask-工程&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#flask-工程&quot;&gt;¶&lt;/a&gt;Flask 工程&lt;/h2&gt;
&lt;p&gt;在apache根目录下建立Flask工程目录如下：&lt;/p&gt;
&lt;figure class=&quot;highlight gherkin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/var/www/html/flaskWeb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      |&lt;span class=&quot;string&quot;&gt; -- app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;         &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- __init__.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;         &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- hello.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;         &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- static&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;         &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;            &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- favicon.ico&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;         &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- templates&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- base.html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- user.html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- index.html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- 404.html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- 500.html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- run.py            # 项目启动文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- course.wsgi       # web接口文件，apache配置需要用到此文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- requirements.txt  # 项目运行所依赖的库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;/span&gt;|&lt;span class=&quot;string&quot;&gt; -- venv              # python虚环境&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该项目中唯一需要注意的地方为wsgi文件的编写：&lt;/p&gt;
&lt;figure class=&quot;highlight nimrod&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 由于该项目在虚环境下运行，此处为启动虚环境&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;activate_this = &#39;/&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/www/html/flaskWeb/venv/bin/activate_this.py&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;execfile(activate_this, dict(__file__=activate_this))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 引入Flask应用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sys.path.insert(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &#39;/&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/www/html/flaskWeb&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; run &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; app &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; application&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;设置完Flask的部分，接下来为Flask应用在apache上的部署&lt;/p&gt;
&lt;h2 id=&quot;apache部署flask应用&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#apache部署flask应用&quot;&gt;¶&lt;/a&gt;Apache部署Flask应用&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;修改apache端口(此处视需求而定)
部署应用由于默认端口被占用，需要改变Apache端口，步骤如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;修改文件&lt;code&gt;/etc/apache2/ports.conf&lt;/code&gt;, 改变如下(设将端口改为8080):&lt;/p&gt;
  &lt;figure class=&quot;highlight apache&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;&lt;span class=&quot;nomarkup&quot;&gt;Listen&lt;/span&gt;&lt;/span&gt; 8080&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;修改默认配置文件&lt;code&gt;/etc/apache2/sites-available/000-default.conf&lt;/code&gt;, 将&lt;code&gt;&amp;lt;VirtualHost *: 80&amp;gt;&lt;/code&gt;改为：&lt;/p&gt;
 &lt;figure class=&quot;highlight apache&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;&amp;lt;VirtualHost *: 8080&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使配置文件生效，并重新加载配置文件&lt;/p&gt;
 &lt;figure class=&quot;highlight gradle&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo a2ensite &lt;span class=&quot;regexp&quot;&gt;/etc/&lt;/span&gt;apache2&lt;span class=&quot;regexp&quot;&gt;/sites-available/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;000&lt;/span&gt;-&lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo service apache2 reload&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;配置flask应用部署文件
在目录&lt;code&gt;/etc/apache2/sites-available&lt;/code&gt;新建文件course.conf(此处可自行命名)，内容如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight apache&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;&amp;lt;VirtualHost *:8080&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 主机域名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;&lt;span class=&quot;nomarkup&quot;&gt;ServerName&lt;/span&gt;&lt;/span&gt; yourweb.com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# WSGI守护进程名，此处还可以设置应用的用户和组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;WSGIDaemonProcess&lt;/span&gt; course&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 配置访问根目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;WSGIScriptAlias&lt;/span&gt; /flaskWeb /var/www/html/flaskWeb/course.wsgi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 配置应用目录访问权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;section&quot;&gt;&amp;lt;Directory /var/www/html/flaskWeb/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# Options指定页面访问规则&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# index 默认按照apache的Indexs配置来选择默认打开的文档&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# FollowSymLinks 在默认文档没有匹配到之后显示整个文件列表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;&lt;span class=&quot;nomarkup&quot;&gt;Options&lt;/span&gt;&lt;/span&gt; Indexes FollowSymLinks Includes ExecCGI&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;WSGIProcessGroup&lt;/span&gt; course&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;WSGIScriptReloading&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;On&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;WSGIApplicationGroup&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;%&amp;#123;GLOBAL&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# 对过滤操作的一个排序，决定优先处理Allow（允许）还是优先处理Deny（拒绝）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;&lt;span class=&quot;nomarkup&quot;&gt;Order&lt;/span&gt;&lt;/span&gt; deny,allow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# 设定可以访问IP, 相当于白名单&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;&lt;span class=&quot;nomarkup&quot;&gt;Allow&lt;/span&gt;&lt;/span&gt; from &lt;span class=&quot;literal&quot;&gt;all&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;section&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;加载配置文件&lt;/p&gt;
 &lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo a2ensite &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;apache2&lt;span class=&quot;meta-keyword&quot;&gt;/sites-available/&lt;/span&gt;course.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo service apache2 reload&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;后记：&lt;/strong&gt;
在部署的过程中遇到一些问题，如在加载Apache配置文件的时候先加载默认配置文件，然后是自定义配置文件。有时，默认的配置文件会对自定义的配置文件产生影响，使得访问应用的时候页面显示应用的目录，通常Apache只加载第一个配置文件，其他配置文件则无效，至于这一点还有待验证！&lt;/p&gt;
&lt;p&gt;参考文献:&lt;/p&gt;
&lt;p&gt;[1] &lt;a href=&quot;http://flask.pocoo.org/docs/0.11/deploying/mod_wsgi/#configuring-apache&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://flask.pocoo.org/docs/0.11/deploying/mod_wsgi/#configuring-apache&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;http://www.jianshu.com/p/6e7e7c58342c&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.jianshu.com/p/6e7e7c58342c&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  Apache Web服务诞生于1995年, 目前在所有网站中，Apache服务的占有率第一。由于多年的发展，其服务相对于其他网站部署服务更加稳定。在面对性能要求不苛刻而对稳定性要求较高的情况下，优先选择Apache。当然，为了应对性能需求，更好的选择为Ngnix。Fla
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Flask" scheme="http://yoursite.com/tags/Flask/"/>
    
  </entry>
  
  <entry>
    <title>Sublime定制</title>
    <link href="http://yoursite.com/2016/06/16/Sublime%E5%AE%9A%E5%88%B6/"/>
    <id>http://yoursite.com/2016/06/16/Sublime定制/</id>
    <published>2016-06-15T17:58:53.000Z</published>
    <updated>2016-06-15T18:32:17.000Z</updated>
    
    <content type="html">&lt;p&gt; Sublime原生的markdown编辑插件MarkDown Editing并不友好。而Monokai extended插件支持对MarkDown进行语法高亮编辑，其安装方法如下：
以下均在Mac OX系统下操作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安装 Monokai extended插件
cmd + shift + p调出control panel输入install package.然后 搜索Monokai extended安装插件&lt;/li&gt;
&lt;li&gt;激活插件，并设置
cmd + shift + p，输入&lt;code&gt;set syntax:markdown extended&lt;/code&gt;，然后在导航栏view --&amp;gt; Syntax --&amp;gt; Open all with current extension as… -&amp;gt; Markdown Extended&lt;/li&gt;
&lt;/ol&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; Sublime原生的markdown编辑插件MarkDown Editing并不友好。而Monokai extended插件支持对MarkDown进行语法高亮编辑，其安装方法如下：
以下均在Mac OX系统下操作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安装 Monokai exte
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Sublime" scheme="http://yoursite.com/tags/Sublime/"/>
    
  </entry>
  
  <entry>
    <title>意外</title>
    <link href="http://yoursite.com/2016/06/15/%E6%84%8F%E5%A4%96/"/>
    <id>http://yoursite.com/2016/06/15/意外/</id>
    <published>2016-06-15T15:59:56.000Z</published>
    <updated>2016-06-15T17:54:42.000Z</updated>
    
    <content type="html">&lt;p&gt; 每次编写markdwon文件总是在排版的问题上出点小的意外，这些意外更多是编辑不熟练导致。虽说从技术的角度将这没什么难度，但却耗费时间调整，本来不错的兴致却被这小的问题弄得一干二净！但文章终究还是要给别人看的，多少还是注意一点为好！&lt;/p&gt;
&lt;h2 id=&quot;代码高亮显示&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#代码高亮显示&quot;&gt;¶&lt;/a&gt;代码高亮显示&lt;/h2&gt;
&lt;p&gt;不同的编程语言除了编写风格不同，其在一些编辑器或者博客中显示也不同。在markdown中也不例外，markdown插入代码块的方式有三种：空格、三个连续 &lt;strong&gt;`&lt;/strong&gt; 和三个连续 &lt;strong&gt;~&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;空格：代码块的起始4个空格, 但是在代码块的前一行必须和非代码块中间用空白行隔开&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;`&lt;/strong&gt; ：代码块以3个该符号开始，并以3个该符号结束，&lt;strong&gt;代码块结束换行无需用双空格结束&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;~&lt;/strong&gt;： 和**`&lt;strong&gt;相同，以3个&lt;/strong&gt;~**开始，以3个该符号结束，同样无需用双空格结束，与前者不同的是，后者在开始的三个符号后加上编程语言的标识。如下所示：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;hello world!&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; 每次编写markdwon文件总是在排版的问题上出点小的意外，这些意外更多是编辑不熟练导致。虽说从技术的角度将这没什么难度，但却耗费时间调整，本来不错的兴致却被这小的问题弄得一干二净！但文章终究还是要给别人看的，多少还是注意一点为好！&lt;/p&gt;
&lt;h2 id=&quot;代码高亮显示&quot;
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MarkDown" scheme="http://yoursite.com/tags/MarkDown/"/>
    
  </entry>
  
  <entry>
    <title>Flask之旅</title>
    <link href="http://yoursite.com/2016/06/11/Flask%E4%B9%8B%E6%97%85/"/>
    <id>http://yoursite.com/2016/06/11/Flask之旅/</id>
    <published>2016-06-11T11:35:37.000Z</published>
    <updated>2016-06-15T17:37:00.000Z</updated>
    
    <content type="html">&lt;p&gt;  Flask是基于Werkzurg工具和jinja2模板引擎构建的轻Web框架, 据说Flask起源于2010年的愚人节玩笑，但是大家反响热烈，作者Armin Ronacher把它变成了一个真正的框架。对于python Web开发者，Flask开发框架容易入门，并且可以快速搭建网站解决问题。&lt;/p&gt;
&lt;h2 id=&quot;flask示例&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#flask示例&quot;&gt;¶&lt;/a&gt;Flask示例:&lt;/h2&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#!/usr/bin/env python&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; flask &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Flask&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; flask &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; request&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app = Flask(__name__)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@app.route(&#39;/&#39;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    user_agent = request.headers.get(&lt;span class=&quot;string&quot;&gt;&#39;User-Agent&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;p&amp;gt;Your brower is %s&amp;lt;/p&amp;gt;&#39;&lt;/span&gt; % user_agent&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&#39;__main__&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    app.run(debug=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;渲染模板&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#渲染模板&quot;&gt;¶&lt;/a&gt;渲染模板&lt;/h2&gt;
&lt;p&gt;上述的代码过于简单，毕竟Web开发，颜值也是相当重要的😇，Flask的模板渲染采用jinja2模板引擎。渲染采用的html文件默认从&lt;code&gt;templates&lt;/code&gt;文件夹中读取，该文件夹与&lt;code&gt;app&lt;/code&gt;文件默认在同一个目录下。采用模板的简单示例如下:&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#!/usr/bin/env python&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; flask &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Flask&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; flask &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; render_template&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app = Flask(__name__)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@app.route(&#39;/&#39;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; render_template(&lt;span class=&quot;string&quot;&gt;&#39;index.html&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@app.route(&#39;/user/&amp;lt;name&amp;gt;&#39;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(name)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; render_template(&lt;span class=&quot;string&quot;&gt;&#39;user.html&#39;&lt;/span&gt;, name=name)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&#39;__main__&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    app.run(debug=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对应的html文件如下:&lt;/p&gt;
&lt;figure class=&quot;highlight 1c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;templates&lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;span class=&quot;string&quot;&gt;|-- index.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;span class=&quot;string&quot;&gt;|-- user.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中user.html文件分别如下:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;h1&lt;/span&gt;&amp;gt;&lt;/span&gt;Hello, &amp;#123;&amp;#123;name&amp;#125;&amp;#125;!&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;h1&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意到user.html文件中 结构表示一个变量，它是一种特殊占位符，表示数据从渲染模板中获取，其识别的类型包括字典，列表和对象等。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  Flask是基于Werkzurg工具和jinja2模板引擎构建的轻Web框架, 据说Flask起源于2010年的愚人节玩笑，但是大家反响热烈，作者Armin Ronacher把它变成了一个真正的框架。对于python Web开发者，Flask开发框架容易入门，并且可以快
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Flask" scheme="http://yoursite.com/tags/Flask/"/>
    
  </entry>
  
  <entry>
    <title>MySQL触发脚本运行</title>
    <link href="http://yoursite.com/2016/05/13/MySQL%E8%A7%A6%E5%8F%91%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C/"/>
    <id>http://yoursite.com/2016/05/13/MySQL触发脚本运行/</id>
    <published>2016-05-13T12:27:06.000Z</published>
    <updated>2016-08-15T01:26:55.000Z</updated>
    
    <content type="html">&lt;p&gt; 触发器是MySQL的一项十分神奇的功能(笑)，它不仅能够保护数据完整性，还能够触发日志记录和数据审计。进行数据库开发时，采用触发器可以适当减少工作量；但采用触发器也有一定的缺点，如增大MySQL服务器的负载，影响服务器性能，数据库的修改对客户端不可见。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;MySQL触发器
MySQL触发器的语法如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DELIMITER $$&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; [DEFINER = &amp;#123;&lt;span class=&quot;keyword&quot;&gt;user&lt;/span&gt; | &lt;span class=&quot;keyword&quot;&gt;current_user&lt;/span&gt;&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;TRIGGER&lt;/span&gt; trigger_name trigger_time trigger_event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; trigger_table&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FOR&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;EACH&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ROW&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    trigger_body;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;END&lt;/span&gt; $$&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DELIMITER;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;trigger_name: 触发器名称，在同一个调度中命名唯一；&lt;/li&gt;
&lt;li&gt;trigger_time: 触发时间，其值为[AFTER, BEFORE];&lt;/li&gt;
&lt;li&gt;trigger_event: 触发事件，其值为[INSERT, UPDATE, DELETE];&lt;/li&gt;
&lt;li&gt;trigger_tabele: 触发表名;&lt;/li&gt;
&lt;li&gt;DEFINER: 产生触发器的用户，拥有一定的权限；其形式为&lt;code&gt;&amp;quot;root&amp;quot;@&amp;quot;localhsot&amp;quot;&lt;/code&gt;, 当不确定用户时，可以通过以下指令查看用户的信息:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; select current_user();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| current_user() |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| root@localhost |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.00 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;利用触发器运行shell/python脚本
MySQL为用户提供了丰富的自定义接口，用户可以根据项目需求自定义函数(UDF)。同时，MySQL提供插件接口，将自定义函数内嵌至MySQL内部。&lt;a href=&quot;http://www.mysqludf.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;UDF Repository &lt;/a&gt;提供开源的MySQL插件。触发器运行脚本需要调用系统的接口，而mysql进程在运行时是以&amp;quot;mysql&amp;quot;用户进行的，&amp;quot;mysql&amp;quot;用户没有徐系统权限，因此，需要通过自定义函数调用系统接口达到运行脚本的目的。本次项目由Jasny提供的&lt;a href=&quot;https://github.com/mysqludf/lib_mysqludf_sys#readme&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;quot;lib_mysqludf_sys&amp;quot;&lt;/a&gt;插件&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统运行环境
ubuntu14.04 64位操作系统&lt;/li&gt;
&lt;li&gt;MySQL版本&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; select version();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| version()               |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 5.6.30-0ubuntu0.14.04.1 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.00 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;下载插件
由于插件是代码贡献者Jasny根据自己运行环境设置，而不同的用户运行环境不同，因此，需要对设置进行一些改变。当下载&amp;quot;lib_mysqludf_sys&amp;quot;插件，修改Make插件。主要修改&amp;quot;plugin_dir&amp;quot;路径，查看该路径的方法如下：&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; show variables like &quot;plugin_dir&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------+------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| Variable_name | Value                  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------+------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| plugin_dir    | /usr/lib/mysql/plugin/ |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------+------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.00 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://xn--Makeinstall-000rt4h76wo52d19a.sh&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;修改Make文件和install.sh&lt;/a&gt;
由上步操作可知，mysql插件的路径为&amp;quot; /usr/lib/mysql/plugin/&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;LIBDIR=&lt;span class=&quot;regexp&quot;&gt;/usr/&lt;/span&gt;lib&lt;span class=&quot;regexp&quot;&gt;/mysql/&lt;/span&gt;plugin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;install:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        gcc -Wall -m64 -I&lt;span class=&quot;regexp&quot;&gt;/usr/&lt;/span&gt;include&lt;span class=&quot;regexp&quot;&gt;/mysql -I. -shared lib_mysqludf_sys.c -o $(LIBDIR)/&lt;/span&gt;lib_mysqludf_sys.so -fPIC&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;修改完成之后运行&lt;code&gt;make install&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;运行下面命令验证安装是否正确&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_exec (&#39;touch /var/lib/mysql/test.txt &#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_exec (&#39;touch /tmp/mysql/test.txt &#39;) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| 32512 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.00 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该命令为在目录“/tmp/mysql”下新建&amp;quot;test.txt&amp;quot;文件，务必确保&amp;quot;/tmp/mysql&amp;quot;目录存在。如果不存在可以先新建该目录sys_exec (&#39;mkdir /tmp/mysql，当函数sys_exec行运行成功，返回值应该为0，同时在&amp;quot;/tmp/mysql&amp;quot;下新建了&amp;quot;test.txt&amp;quot;文件。显然，上述的新建文件过程并未成功。这是由于函数sys_exec()在调用系统命令时受到了AppAemor的限制。AppArmor是一个高效和易用的Linux系统安全应用程序，用以保护系统和应用程序不受攻击。因此，系统调用时需要禁止其对mysql的限制，如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo ln -s /etc/apparmor.d/usr&lt;span class=&quot;selector-class&quot;&gt;.sbin&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.mysqld&lt;/span&gt; /etc/apparmor.d/disable/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apparmor_parser -R /etc/apparmor.d/usr&lt;span class=&quot;selector-class&quot;&gt;.sbin&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.mysqld&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;再次验证&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_eval(&#39;id&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_eval(&#39;id&#39;)                                  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| uid=116(mysql) gid=125(mysql) groups=125(mysql) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.09 sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_exec(&#39;mkdir /home/marvin/mysql&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_exec(&#39;mkdir /tmp/mysql&#39;) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;|                                  256 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.02 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;验证如上则成功，但是对于sys_exec函数返回不为0，查看mysql日志，看是否有权限问题。修改文件的权限, 如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo chown -R &lt;span class=&quot;string&quot;&gt;mysql:&lt;/span&gt;mysql &lt;span class=&quot;regexp&quot;&gt;/tmp/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;完整测试，运行脚本&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;新建文件夹&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_exec(&#39;mkdir /tmp/mysql&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_exec(&#39;mkdir /tmp/mysql&#39;) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;|                          256 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.02 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;新建文件，并赋予其可执行权限&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_exec(&#39;touch /tmp/mysql/run.sh&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_exec(&#39;touch /tmp/mysql/run.sh&#39;) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;|                                   0 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.01 sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;mysql&amp;gt; SELECT sys_exec(&#39;chmod +x /tmp/mysql/run.sh&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;| sys_exec(&#39;chmod +x /tmp/mysql/run.sh&#39;) |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;|                                      0 |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+----------------------------------------+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1 row in set (0.15 sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;编辑run.sh如下：&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&quot;highlight ruby&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;echo &lt;span class=&quot;string&quot;&gt;&quot;hi, i got you!&quot;&lt;/span&gt; &lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt; &lt;/span&gt;/tmp/mysql/log.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;设置触发器，当在account表中添加数据，触发脚本运行&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DELIMITER //&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIGGER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;EXISTS&lt;/span&gt; testTrigger;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIGGER&lt;/span&gt; testTrigger &lt;span class=&quot;keyword&quot;&gt;AFTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;account&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FOR&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;EACH&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ROW&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;DECLARE&lt;/span&gt; cmd &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;DECLARE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; cmd = &lt;span class=&quot;string&quot;&gt;&quot;/tmp/mysql/run.sh&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;result&lt;/span&gt; =  sys_exec(cmd);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;END&lt;/span&gt;; //&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;提示&lt;/strong&gt;： 当写MySQL语句块时，正常情况下出现&amp;quot;;&amp;quot;,sql语句直接执行并结束。但有时候希望多条语句连续执行，则可以用需要更换界定符，通常将界定符换为&amp;quot;//&amp;quot;,当再次出现该界定符时，MySQL语句执行结束。&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;验证上述操作
在MySQL的&amp;quot;test&amp;quot;数据库&amp;quot;account&amp;quot;表中添加数据，查看文件&amp;quot;/tmp/mysql/log.txt&amp;quot;, 如下则证明操作成功:&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;marvin&lt;span class=&quot;variable&quot;&gt;@acer:&lt;/span&gt;~$ sudo cat /tmp/mysql/log.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hi, i got you!&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;总结
MySQL触发器触发脚本运行应当注意文件的权限问题，在mysql环境下，所有命令产生的文件的所有权均为&amp;quot;mysql&amp;quot;，但是&amp;quot;msyql&amp;quot;无系统的权限。因此，当运行过程中出现问题，通过查看log查找问题。另外，在Python虚环境中运行python脚本也应当注意文件权限的问题。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参考文献
[1] &lt;a href=&quot;https://github.com/mysqludf/lib_mysqludf_sys/issues/4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/mysqludf/lib_mysqludf_sys/issues/4&lt;/a&gt;
[2] &lt;a href=&quot;http://dev.mysql.com/doc/refman/5.7/en/create-trigger.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://dev.mysql.com/doc/refman/5.7/en/create-trigger.html&lt;/a&gt;
[3] &lt;a href=&quot;http://www.cnblogs.com/rootq/archive/2009/05/27/1490523.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/rootq/archive/2009/05/27/1490523.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; 触发器是MySQL的一项十分神奇的功能(笑)，它不仅能够保护数据完整性，还能够触发日志记录和数据审计。进行数据库开发时，采用触发器可以适当减少工作量；但采用触发器也有一定的缺点，如增大MySQL服务器的负载，影响服务器性能，数据库的修改对客户端不可见。&lt;/p&gt;
&lt;ol&gt;

    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Crontab</title>
    <link href="http://yoursite.com/2016/04/27/crontab/"/>
    <id>http://yoursite.com/2016/04/27/crontab/</id>
    <published>2016-04-27T08:10:39.000Z</published>
    <updated>2016-07-03T04:44:40.000Z</updated>
    
    <content type="html">&lt;p&gt; crontab是linux下用来周期性执行某种任务的守护进程，是系统默认启动的服务。crontab每分钟定期检查是否有任务需要执行，如果有则自动执行任务&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;crontab定时脚本简介&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;linux下的任务调度分为系统任务调度和用户任务调度。
系统任务调度：系统周期性要执行的工作，如读写缓存数据到硬盘、日志清理
crontab 任务包括下面几行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  [root@localhost ~]cat /etc/crontab
  SHELL=/bin/bash
  PATH=/envpath/to/run/script
  MAILTO=&amp;quot;&amp;quot;
  HOME=/
  # run-part
  21 * * * * root run-part /script/to/run
  42 * 1 * * root run-part /script/to/run
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;crontab文件的前几行定义了运行脚本的环境变量和运行脚本的路径。第一行&lt;code&gt;SHELL&lt;/code&gt;定义了系统需要用哪个shell,此处为bash；第二行&lt;code&gt;PATH&lt;/code&gt;定义了运行命令的环境变量；第三行&lt;code&gt;MAILTO&lt;/code&gt;定义了系统执行命令时通过电子邮件发送信息给crontab用户,当为空时则表示不发送任务执行信息给用户；第四行&lt;code&gt;HOME&lt;/code&gt;指定指定命令或脚本时的主目录。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;用户任务调度： 用户定期执行任务，如数据备份或邮件通知等。用户也可以通过crontab建立自己的任务执行计划，用户定义的crontab被保存在&lt;code&gt;/var/spool/cron/crontabs&lt;/code&gt;(系统版本ubunut14.04)目录，注意文件名与用户名一致。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;crontab的文件格式共分为六个字段，前五个为时间格式设定，最后一段为命令，格式如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;      * * * * * cmd script_to_run
      | | | | | |   |
      | | | | | | ----------- 需要运行的脚本文件
      | | | | |  ------------ 运行脚本的命令
      | | | | -------------- 星期,取值范围为0-7
      | | | ---------------- 月,取值范围为1-12
      | | --------------- -- 日,取值范围为1-31
      | ------------------- 时,取值范围0-23
      --------------------- 分,取值范围0-59
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在以上各个字段中，可以使用以下特殊字符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;星号(*): 代表所有可能值&lt;/li&gt;
&lt;li&gt;逗号(,): 逗号隔开取值，表示列表范围，如“1，2，5，7”&lt;/li&gt;
&lt;li&gt;中杠(-): 表示范围，如“1-7”，表示取值从1到7&lt;/li&gt;
&lt;li&gt;正斜杠(/): 表示时间间隔频率，第一个时间字符为“*/2”, 表示每2分钟&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;crontab定时运行脚本步骤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;新建crontab文件mytab并载入系统&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  crontab mytab
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看crontab文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  crontab -l
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;编辑crontab文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  crontab -e
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;删除crontab文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   crontab -r
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;编辑crontab文件的具体方法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;每5分钟定时运行脚本，例：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; */5 * * * * cmd script
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;每天6点运行脚本，例：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  0 6 * * * cmd script
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2015年10月7日12点17分运行脚本&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  17 12 7 10 2015 cmd script
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;每月周一到周三的晚上11点到早上7点之间每隔1个小时重启smb&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  * 23-7/1 * * 1-3 /etc/init.d/smb restart
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;每月的4号与周一到周三的11点重启smb&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  * 11 4 * mon-wek /etc/init.d/smb restart
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ubuntu14.04查看crontab日志&lt;/p&gt;
&lt;p&gt; 当crontab编辑正确且手动执行脚本可运行，但crontab不起作用，这事需要通过查看cronbtab的日志查找问题所在。ubuntu14.04系统默认不开启crontab日志。因此，需要手动解锁cron日志，修改rsyslog, 具体方法如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo vi &lt;span class=&quot;regexp&quot;&gt;/etc/&lt;/span&gt;rsyslog.d/&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;-&lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在脚本的第10行解除&lt;code&gt;cron.*&lt;/code&gt;
重启rsyslog,&lt;/p&gt;
 &lt;figure class=&quot;highlight maxima&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo service rsyslog &lt;span class=&quot;built_in&quot;&gt;restart&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; 重启rsyslog之后， 在目录&lt;code&gt;/var/log&lt;/code&gt;下可以找到&lt;code&gt;cron.log&lt;/code&gt;, 当出现问题，可以通过查看日志查找问题所在。cron查找另一个问题的利器是通过发送邮件给用户，邮件中通常指出问题所在，比log所提供的信息要多。主要的linux分布版本自带邮件代理服务，但ubuntu是个特例，因此需要手动安装。安装指令如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight maxima&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-&lt;span class=&quot;built_in&quot;&gt;get&lt;/span&gt; install &lt;span class=&quot;built_in&quot;&gt;postfix&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意环境变量(系统为ubuntu14.04)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;crontab与相对路径
 在执行脚本的时候，如果脚本中含有从其他位置引入的模块(&lt;font color=&quot;red&quot;&gt;即引用了相对位置&lt;/font&gt;)，在crontab中直接编辑命令听行运行脚本会产生错误。这种错误通常是由运行环境不同导致。由于运行环境不同，无法从相对路径中引入脚本运行的模块，导致运行脚本失败。解决的办法时，在运行脚本之前，先通过脚本将运行环境过渡到手动运行脚本的环境，然后在crontab文件中编辑相应的命令行。一个比较好的做法是，将所有需要执行的命令编入到一个总的shell脚本中，通过crontab 控制该shell脚本的运行。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;crontab与shell
在了解crontable加载shell之前需要了解几个与shell有关的文件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/etc/profile: 该文件为每个用户设置系统环境变量，当用户登录时，该文件被执行一次并从文件&lt;code&gt;/ect/bash.bashrc&lt;/code&gt;和 目录&lt;code&gt;/etc/profile.d&lt;/code&gt;下加载shell设置&lt;/li&gt;
&lt;li&gt;/etc/bash.bashrc: 为每个运行bash shell的用户执行此文件&lt;/li&gt;
&lt;li&gt;~/.profile: 该为用户级加载shell设置环境变量，当用户登入时该文件执行一次，并加载&lt;code&gt;~/.bashrc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;~/.bashrc: 用户自定义shell环境变量，用户登录或打开新的shell该文件被执行
注意：前两个文件为全局shell设置，后两者针对特定用户设置&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt; crontab在加载环境设置的时候并不主动从&lt;strong&gt;profile&lt;/strong&gt;文件中加载环境设置，因此会导致在手动运行脚本的时候不会出现问题，但当cron运行脚本的时候却发现脚本无法运行。
一个比较好的方法是在总的控制脚本前先加载&lt;code&gt;profile&lt;/code&gt;, 如下：&lt;/p&gt;
 &lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;. &lt;/span&gt;/etc/profile&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;. &lt;/span&gt;~/.profile&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;另外， 如果用到第三方的一些命令行，则可以通过在linux系统共享库(*.so)中加载相应的目录&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;[1] &lt;a href=&quot;http://www.cnblogs.com/peida/archive/2013/01/08/2850483.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/peida/archive/2013/01/08/2850483.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;http://alfred-sun.github.io/blog/2015/06/18/daemon-implementation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://alfred-sun.github.io/blog/2015/06/18/daemon-implementation/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] &lt;a href=&quot;http://www.justwinit.cn/post/3377/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.justwinit.cn/post/3377/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; crontab是linux下用来周期性执行某种任务的守护进程，是系统默认启动的服务。crontab每分钟定期检查是否有任务需要执行，如果有则自动执行任务&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;crontab定时脚本简介&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;linux下的任务调度
    
    </summary>
    
      <category term="技术" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>启航</title>
    <link href="http://yoursite.com/2016/04/24/%E5%90%AF%E8%88%AA/"/>
    <id>http://yoursite.com/2016/04/24/启航/</id>
    <published>2016-04-24T08:25:15.000Z</published>
    <updated>2016-06-15T13:36:26.000Z</updated>
    
    <content type="html">&lt;p&gt; 很早就酝酿搭建一个自己的博客，但由于其他一些原因一直未能实现。最近，在搜集一些专业方面的资料，一方面感觉在东西写得比较乱，很大的原因可能是除了自己每人会看，也不在乎排版和美观，事后也没有那么大的兴趣再回首，这是一个及其不好的习惯；另一方，在查资料更的过程中也看到一些很好的Blog，其中也不乏比较优美的文字与排版，但总的看来&lt;a href=&quot;http://wuchong.me&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Jark’s Blog&lt;/a&gt;的简约风格使我印象深刻,于是周末花了一天时间按照其Blog的风格搭建了自己的博客 😄 😃 💥&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; 很早就酝酿搭建一个自己的博客，但由于其他一些原因一直未能实现。最近，在搜集一些专业方面的资料，一方面感觉在东西写得比较乱，很大的原因可能是除了自己每人会看，也不在乎排版和美观，事后也没有那么大的兴趣再回首，这是一个及其不好的习惯；另一方，在查资料更的过程中也看到一些很好的
    
    </summary>
    
      <category term="朝夕" scheme="http://yoursite.com/categories/%E6%9C%9D%E5%A4%95/"/>
    
    
      <category term="朝夕" scheme="http://yoursite.com/tags/%E6%9C%9D%E5%A4%95/"/>
    
  </entry>
  
</feed>
