<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Crontab | Marvin's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Crontab</h1><a id="logo" href="/.">Marvin's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/project/"><i class="fa fa-tree"> 项目</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/history/"><i class="fa fa-book"> 历史</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Crontab</h1><div class="post-meta">Apr 27, 2016<span> | </span><span class="category"><a href="/categories/技术/">技术</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p> crontab是linux下用来周期性执行某种任务的守护进程，是系统默认启动的服务。crontab每分钟定期检查是否有任务需要执行，如果有则自动执行任务</p>
<ol>
<li>
<p>crontab定时脚本简介</p>
<ul>
<li>
<p>linux下的任务调度分为系统任务调度和用户任务调度。<br>
系统任务调度：系统周期性要执行的工作，如读写缓存数据到硬盘、日志清理
crontab 任务包括下面几行：</p>
<pre><code>  [root@localhost ~]cat /etc/crontab
  SHELL=/bin/bash  
  PATH=/envpath/to/run/script  
  MAILTO=&quot;&quot;  
  HOME=/ 
  # run-part  
  21 * * * * root run-part /script/to/run
  42 * 1 * * root run-part /script/to/run  
</code></pre>
</li>
</ul>
<p>crontab文件的前几行定义了运行脚本的环境变量和运行脚本的路径。第一行<code>SHELL</code>定义了系统需要用哪个shell,此处为bash；第二行<code>PATH</code>定义了运行命令的环境变量；第三行<code>MAILTO</code>定义了系统执行命令时通过电子邮件发送信息给crontab用户,当为空时则表示不发送任务执行信息给用户；第四行<code>HOME</code>指定指定命令或脚本时的主目录。</p>
<ul>
<li>
<p>用户任务调度： 用户定期执行任务，如数据备份或邮件通知等。用户也可以通过crontab建立自己的任务执行计划，用户定义的crontab被保存在<code>/var/spool/cron/crontabs</code>(系统版本ubunut14.04)目录，注意文件名与用户名一致。</p>
</li>
<li>
<p>crontab的文件格式共分为六个字段，前五个为时间格式设定，最后一段为命令，格式如下：</p>
<pre><code>      * * * * * cmd script_to_run
      | | | | | |   |    
      | | | | | | ----------- 需要运行的脚本文件
      | | | | |  ------------ 运行脚本的命令
      | | | | -------------- 星期,取值范围为0-7  
      | | | ---------------- 月,取值范围为1-12
      | | --------------- -- 日,取值范围为1-31
      | ------------------- 时,取值范围0-23
      --------------------- 分,取值范围0-59  
</code></pre>
<p>在以上各个字段中，可以使用以下特殊字符：</p>
<ul>
<li>星号(*): 代表所有可能值</li>
<li>逗号(,): 逗号隔开取值，表示列表范围，如“1，2，5，7”</li>
<li>中杠(-): 表示范围，如“1-7”，表示取值从1到7</li>
<li>正斜杠(/): 表示时间间隔频率，第一个时间字符为“*/2”, 表示每2分钟</li>
</ul>
</li>
</ul>
</li>
<li>
<p>crontab定时运行脚本步骤</p>
<ul>
<li>
<p>新建crontab文件mytab并载入系统</p>
<pre><code>  crontab mytab
</code></pre>
</li>
<li>
<p>查看crontab文件</p>
<pre><code>  crontab -l
</code></pre>
</li>
<li>
<p>编辑crontab文件</p>
<pre><code>  crontab -e  
</code></pre>
</li>
<li>
<p>删除crontab文件</p>
<pre><code>   crontab -r  
</code></pre>
</li>
</ul>
</li>
<li>
<p>编辑crontab文件的具体方法</p>
<ul>
<li>
<p>每5分钟定时运行脚本，例：</p>
<pre><code> */5 * * * * cmd script  
</code></pre>
</li>
<li>
<p>每天6点运行脚本，例：</p>
<pre><code>  0 6 * * * cmd script  
</code></pre>
</li>
<li>
<p>2015年10月7日12点17分运行脚本</p>
<pre><code>  17 12 7 10 2015 cmd script          
</code></pre>
</li>
<li>
<p>每月周一到周三的晚上11点到早上7点之间每隔1个小时重启smb</p>
<pre><code>  * 23-7/1 * * 1-3 /etc/init.d/smb restart
</code></pre>
</li>
<li>
<p>每月的4号与周一到周三的11点重启smb</p>
<pre><code>  * 11 4 * mon-wek /etc/init.d/smb restart  
</code></pre>
</li>
</ul>
</li>
</ol>
<p>参考资料：<br>
[1] <a href="http://www.cnblogs.com/peida/archive/2013/01/08/2850483.html" target="_blank" rel="external">http://www.cnblogs.com/peida/archive/2013/01/08/2850483.html</a><br>
[2] <a href="http://alfred-sun.github.io/blog/2015/06/18/daemon-implementation/" target="_blank" rel="external">http://alfred-sun.github.io/blog/2015/06/18/daemon-implementation/</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/04/27/crontab/" data-id="cipgxeqnz0001i6wdlyahr6l4" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Linux/">Linux</a></div><div class="post-nav"><a href="/2016/05/13/MySQL触发脚本运行/" class="pre">MySQL触发脚本运行</a><a href="/2016/04/24/启航/" class="next">启航</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/朝夕/">朝夕</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Flask/" style="font-size: 15px;">Flask</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/朝夕/" style="font-size: 15px;">朝夕</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/11/Flask之旅/">Flask之旅</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/13/MySQL触发脚本运行/">MySQL触发脚本运行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/27/crontab/">Crontab</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/启航/">启航</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://omnilab.sjtu.edu.cn/" title="OMNILab" target="_blank">OMNILab</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Marvin's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>